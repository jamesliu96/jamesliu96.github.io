/*
Original by:
Copyright (C) 2013 Justin Windle, http://soulwire.co.uk

Improved, modified and adapted by:
Copyright (C) 2014 James Liu (james@jamesliu.info)
*/

var Sketch=function(){"use strict";function D(a){return"function"==typeof a}function r(a,b,c){for(var k in b)if(c||!a.hasOwnProperty(k))a[k]=b[k];return a}function V(a,b){return function(){a.apply(b,arguments)}}function W(a){function b(U){D(U)&&U.apply(a,[].splice.call(arguments,1))}function c(a){for(f=0;f<n.length;f++)s=n[f],"string"==typeof s?d[(a?"add":"remove")+"EventListener"].call(d,s,w,!1):D(s)?w=s:d=s}function k(){E(v);v=x(k);K||(b(a.setup),K=D(a.setup),b(a.resize));a.running&&!L&&(a.dt=(A=+new Date)-a.now,a.millis+=a.dt,a.now=A,b(a.update),a.autoclear&&M&&a.clear(),b(a.draw));L=++L%a.interval}function g(){d=C?a.style:a.canvas;N=C?"px":"";a.fullscreen&&(a.height=t.innerHeight,a.width=t.innerWidth);d.height=a.height+N;d.width=a.width+N;a.retina&&M&&y&&(d.height=a.height*y,d.width=a.width*y,d.style.height=a.height+"px",d.style.width=a.width+"px",a.scale(y,y));K&&b(a.resize)}function h(b,c){O=a.element.getBoundingClientRect();b.x=b.pageX-O.left-t.scrollX;b.y=b.pageY-O.top-t.scrollY;c=c||{};c.ox=c.x||b.x;c.oy=c.y||b.y;c.x=b.x;c.y=b.y;c.dx=c.x-c.ox;c.dy=c.y-c.oy;return c}function e(c){c.preventDefault();var k={},d;for(d in c)D(c[d])?k[d]=V(c[d],c):k[d]=c[d];m=k;m.originalEvent=c;if(m.touches)for(p.length=m.touches.length,f=0;f<m.touches.length;f++)p[f]=h(m.touches[f],p[f]);else p.length=0,p[0]=h(m,P);r(P,p[0],!0);c=m;z=(Q=n.indexOf(R=c.type))-1;for(a.dragging=/down|start/.test(R)?!0:/up|end/.test(R)?!1:a.dragging;z;)"string"==typeof n[z]?b(a[n[z--]],c):"string"==typeof n[Q]?b(a[n[Q++]],c):z=0}function l(){a.now=+new Date;a.running=!0}function F(){a.running=!1}var v,w,d,q,O,f,N,A,s,m,R,u,B,z,Q,L=0,p=[],K=!1,y=t.devicePixelRatio,C=a.type==G,M=a.type==H,P={x:0,y:0,ox:0,oy:0,dx:0,dy:0},n=[a.element,e,"mousedown","touchstart",e,"mousemove","touchmove",e,"mouseup","touchend",e,"click",S,function(c){u=c.keyCode;B="keyup"==c.type;I[u]=I[T[u]||String.fromCharCode(u)]=!B;b(a[c.type],c)},"keydown","keyup",t,function(c){a.autopause&&("blur"==c.type?F:l)();b(a[c.type],c)},"focus","blur",g,"resize"],I={};for(u in T)I[T[u]]=!1;r(a,{touches:p,mouse:P,keys:I,dragging:!1,running:!1,millis:0,now:NaN,dt:NaN,destroy:function(){q=a.element.parentNode;f=J.indexOf(a);q&&q.removeChild(a.element);~f&&J.splice(f,1);c(!1);F()},toggle:function(){(a.running?F:l)()},clear:function(){M&&a.clearRect(0,0,a.width,a.height)},start:l,stop:F});J.push(a);return a.autostart&&l(),c(!0),g(),k(),a}for(var v="E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min".split(" "),g=Math,H="canvas",G="dom",S=document,t=window,J=[],A={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,container:S.body,interval:1,globals:!0,retina:!1,type:H},T={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},h,B,w={CANVAS:H,WEB_GL:"webgl",WEBGL:"webgl",DOM:G,instances:J,install:function(a){if(!a.__hasSketch){for(var b=0;b<v.length;b++)a[v[b]]=g[v[b]];r(a,{TWO_PI:2*g.PI,HALF_PI:g.PI/2,QUATER_PI:g.PI/4,random:function(a,b){if("[object Array]"==Object.prototype.toString.call(a))return a[~~(g.random()*a.length)];"number"!=typeof b&&(b=a||1,a=0);return a+g.random()*(b-a)},lerp:function(a,b,e){return a+e*(b-a)},map:function(a,b,e,g,h){return(a-b)/(e-b)*(h-g)+g}});a.__hasSketch=!0}},create:function(a){a=r(a||{},A);a.globals&&w.install(self);h=a.element=a.element||S.createElement(a.type===G?"div":"canvas");B=a.context=a.context||function(){switch(a.type){case H:return h.getContext("2d",a);case "webgl":return h.getContext("webgl",a)||h.getContext("experimental-webgl",a);case G:return h.canvas=h}}();a.container.appendChild(h);return w.augment(B,a)},augment:function(a,b){b=r(b||{},A);b.element=a.canvas||a;b.element.className?b.element.className+=" sketch":b.element.className="sketch";r(a,b,!0);return W(a)}},q=["ms","moz","webkit","o"],e=self,C=0,x=e.requestAnimationFrame,E=e.cancelAnimationFrame,l=0;l<q.length&&!x;l++)x=e[q[l]+"RequestAnimationFrame"],E=e[q[l]+"CancelrequestAnimationFrame"];e.requestAnimationFrame=x=x||function(a){var b=+new Date,c=g.max(0,16-(b-C)),e=setTimeout(function(){a(b+c)},c);C=b+c;return e};e.cancelAnimationFrame=E=E||function(a){clearTimeout(a)};return w}();